<div class="message-wrapper" [class.own]="isOwn" [class.other]="!isOwn">
    <div class="message-bubble" [class.own-bubble]="isOwn" [class.other-bubble]="!isOwn">
        <!-- Sender name for support/admin messages -->
        <div class="sender-name" *ngIf="!isOwn && showSenderName">
            <strong>{{ senderLabel }}</strong>
        </div>

        <!-- Message content -->
        <div class="message-content">
            <p class="message-text">{{ message.content }}</p>

            <!-- Attachment if exists -->
            <div class="message-attachment" *ngIf="message.attachmentUrl">
                <a [href]="message.attachmentUrl" target="_blank" rel="noopener noreferrer">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z" />
                    </svg>
                    Attachment
                </a>
            </div>
        </div>

        <!-- Message footer: time + read status -->
        <div class="message-footer">
            <span class="message-time">{{ messageTime }}</span>

            <!-- WhatsApp-style read indicators (only for own messages) -->
            <span class="read-status" *ngIf="isOwn">
                <!-- Double tick (checkmarks) -->
                <svg class="tick-icon" [class.read]="message.isRead" [class.sent]="!message.isRead" width="16"
                    height="12" viewBox="0 0 16 12">
                    <!-- First checkmark -->
                    <path d="M5.5 9L2 5.5L3.5 4L5.5 6L10.5 1L12 2.5L5.5 9Z" fill="currentColor" />
                    <!-- Second checkmark (slightly offset) -->
                    <path d="M9.5 9L6 5.5L7.5 4L9.5 6L14.5 1L16 2.5L9.5 9Z" fill="currentColor" />
                </svg>
            </span>
        </div>

        <!-- Delete button (only for own messages) -->
        <button class="delete-btn" *ngIf="isOwn" (click)="onDelete()" title="Delete message">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                <path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z" />
            </svg>
        </button>
    </div>
</div>